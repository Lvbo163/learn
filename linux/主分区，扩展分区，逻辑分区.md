# 主分区、扩展分区、逻辑分区

在Linux系统下(其他操作系统也有类似的规定)，磁盘的分区大致可以分为三类，分别为**主分区、扩展分区和逻辑分区**等等。Linux系统管理员在部署系统时，必须要对这三个分区进行一个合理的规划，否则的话会浪费宝贵的硬盘空间。

## 主分区 Primary Partition
通常情况下，一个硬盘中最多能够分割四个主分区。这是因为硬盘中分区表的大小只有64Bytes，而分割一个分区就需要利用16Bytes空间来存储这个分区的相关信息。由于这个分区表大小的限制，硬盘只能够分给为四个主分区。主分区编号为hda1-4，逻辑分区从5开始。

> 硬盘的容量=主分区的容量+扩展分区的容量

如果此时一块硬盘有120个G，而管理员划分了4个主分区，每个主分区的空间为20个G。那么总共才用去了80G的空间。这块硬盘剩余的40G空间就将无法使用。这显然浪费了硬盘的空间。

## 扩展分区Extension Partion与逻辑分区Logical Partion
为了突破这最多四个主分区的限制，Linux系统引入了扩展分区的概念。即管理员可以把其中一个主分区设置为扩展分区(注意只能够使用一个扩展分区)来进行扩充。而在扩展分区下，又可以建立多个逻辑分区。**也就是说，扩展分区是无法直接使用的，必须在细分成逻辑分区才可以用来存储数据** 通常情况下，逻辑分区的起始位置及结束位置记录在每个逻辑分区的第一个扇区，这也叫做扩展分区表。在扩展分区下，系统管理员可以根据实际情况建立多个逻辑分区，将一个扩展分区划割成多个区域来使用。

> 扩展分区的容量=各个逻辑分区的容量之和

所以在扩展分区与逻辑分区的帮助下，一块硬盘可以被划分为六个、七个甚至更多的分区。有时候由于磁盘限额的需要，要给不同的用户或者应用对应不同的分区。用户主目录的规划，这也需要用到一个独立的分区。故系统管理员需要在部署系统之前，先考虑一下系统到底有分几个区合适。故硬盘分区空间该如何规划，这是系统管理员在部署Linux系统之前需要回答的问题。

## 分区编号

前文说到，一个硬盘中最多只能有4个主分区（扩展分区也是主分区）。系统主分区编号为hda1-4，逻辑分区从5开始。

分区编号 had1 各位代表着不同的含义:
- 前两位代表硬盘类型
 > hd：IDE硬盘。
 > 
 > sd: 是SCSI硬盘

- 第三位 a 代表硬盘序号 第一块硬盘。如果是第二块硬盘，则为b，依此类推c,d……. 一台电脑可能有多块硬盘
- 第4位数字 代表分区编号，1-4为主分区，5-16为逻辑分区。

## 主引导记录MBR(Master Boot Record)
一开始PC被设计成这样的启动过程,开机时主板BIOS进行自检,当一切OK后,就开始读取硬盘的第一个扇区,俗称硬盘的零扇区。一个扇区的大小是512字节,这是计算机工业里的标准,无论什么硬盘,一个扇区的大小都是512字节.BIOS把这512字节的内容读出来并执行.这512字节被叫做主引导记录.这512字节包含了硬盘最重要的信息:分区表（Partition Table）.由于空间只有区区512字节,所以分区表的大小就有很大限制,他被设计成十分小但是又足够描述硬盘的分区情况.包括分区的开始扇区,结束扇区,引导标志,分区类型等等.

每个分区信息用16个字节表示,四个分区就用掉了16X4=64个字节, 这64个字节分布在MBR的第467-510字节,俗称的分区表后面紧接着两个字节511,512被称为幻数(Magic Number)。

OIS读取MBR的时候总是检查最后是不是有这两个幻数,如果没有就被认为是一个没有被分区的硬盘.尽管分区表中明明有数据,也会报错,告诉你系统不存在. **所以,对硬盘加密的简单办法就是从MBR中察掉这两个字节.** 那么这个硬盘挂到任何电脑上都会显示为一个没有分区的空白硬盘.但是只要把这两个字节重新写上,数据又能读出. 当然,你得知道怎么重新写上.

如果分的一个主分区，一个扩展分区，实际才用去分区表32字节，还有两个为零。

![mbr](http://s5.sinaimg.cn/mw690/001ZSAZWgy71PT7V7bme4&690)
